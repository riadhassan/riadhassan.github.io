{% capture footer_contents %}
  &copy; Copyright {{ site.time | date: '%Y' }}
  {{ site.first_name }} {{ site.middle_name }} {{ site.last_name }}. {{ site.footer_text }}
  {% if site.impressum_path %}
    <a href="{{ site.url }}{{ site.baseurl }}{{ site.impressum_path }}">Impressum</a>.
  {% endif %}
  {% if site.last_updated %}
    Last updated: {{ 'now' | date: '%B %d, %Y' }}.
  {% endif %}
{% endcapture %}

{% if site.footer_fixed %}
  <footer class="fixed-bottom" role="contentinfo">
    <div class="container mt-0">
      {{ footer_contents }}
    </div>
  </footer>
{% else %}
  <footer class="sticky-bottom mt-5" role="contentinfo">
    {% if site.newsletter.enabled %}
      {% include newsletter.liquid %}
    {% endif %}
    <div class="social">
      <p style="margin:0px">
        <b>Email:</b>
        <span id="my-email"></span>

        <script>
          document.getElementById('my-email').textContent = 'a_so@.ronutadahiskcaml'
            .split('')
            .sort(() => 0.5 - Math.random())
            .join('');
        </script>
        <a
          href="#"
          onclick="
            const btn = this;
            const emailElement = document.getElementById('my-email');
            const originalText = emailElement.textContent;

            btn.textContent = 'Unscrambling...';
            btn.style.pointerEvents = 'none';
            btn.style.color = '#999';

            emailElement.style.display = 'inline-block';
            emailElement.style.transition = 'all 0.5s';

            const s = 'aoulhd@rnotamssko_cioa.';
            const k = [9, 12, 13, 15, 5, 3, 11, 0, 10, 16, 14, 2, 22, 8, 7, 18, 21, 4, 20, 1, 17, 6, 19];
            let e = [];
            for(let i = 0; i < k.length; i++) e[k[i]] = s[i];
            const decodedEmail = e.join('');

            let step = 0;
            const animateUnscramble = () => {
                if (step >= 20) {
                    emailElement.textContent = decodedEmail;
                    emailElement.style.animation = 'none';
                    emailElement.style.transform = 'translateY(0)';
                    emailElement.style.opacity = '1';
                    emailElement.style.color = '#000';

                    setTimeout(() => {
                        btn.remove();
                    }, 300);
                    return;
                }

                emailElement.style.transform = `translateY(${Math.sin(step * 2) * 3}px)`;
                emailElement.style.opacity = (0.3 + (step / 20) * 0.7).toString();

                let displayText = '';
                for (let i = 0; i < decodedEmail.length; i++) {
                    if (i < Math.floor(step * decodedEmail.length / 20)) {
                        displayText += decodedEmail[i];
                    } else {
                        const chars = 'abcdefghijklmnopqrstuvwxyz@._0123456789';
                        displayText += chars[Math.floor(Math.random() * chars.length)];
                    }
                }

                emailElement.textContent = displayText;
                step++;
                setTimeout(animateUnscramble, 50); // 50ms between steps
            };

            // Start animation
            animateUnscramble();
            return false;
          "
          style="margin-left:8px;"
          >[Unscramble]</a
        >
      </p>

      <div class="contact-icons">
        <a
          href="https://github.com/riadhassan"
          target="_blank"
          style="color: #000; text-decoration: none;"
          title="GitHub"
        >
          <i class="fa-brands fa-github"></i>
        </a>
        <a
          href="https://www.linkedin.com/in/riadhassan/"
          target="_blank"
          style="color: #000; text-decoration: none;"
          title="LinkedIn"
        >
          <i class="fa-brands fa-linkedin"></i>
        </a>
        <a
          href="https://scholar.google.com/citations?user=heXZzcQAAAAJ&hl=en"
          target="_blank"
          style="color: #000; text-decoration: none;"
          title="Google Scholar"
        >
          <i class="ai ai-google-scholar"></i>
        </a>
      </div>
    </div>
    <div class="container">
      {{ footer_contents }}
    </div>
  </footer>
{% endif %}
